@model HomeLoan.Models.LoanApplication
@{
    ViewData["Title"] = "Loan Application Status";
}

<div class="container my-5">
    <div class="card shadow-lg">
        <div class="card-header text-white" style="background-color:#004aad;">
            <h4 class="mb-0">🏦 Home Loan Application Status</h4>
        </div>

        <div class="card-body p-4">

            <div class="row">
                <div class="col-md-6 mb-3">
                    <h6>Application ID:</h6>
                    <p class="fw-semibold">@Model.Id</p>
                </div>
                <div class="col-md-6 mb-3">
                    <h6>Applicant Name:</h6>
                    <p class="fw-semibold">@Model.FirstName @Model.LastName</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <h6>Property:</h6>
                    <p class="fw-semibold">@Model.PropertyName</p>
                </div>
                <div class="col-md-6 mb-3">
                    <h6>Loan Amount:</h6>
                    <p class="fw-semibold">₹@String.Format("{0:N0}", Model.LoanAmount)</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <h6>Interest Rate:</h6>
                    <p class="fw-semibold">@Model.InterestRate%</p>
                </div>
                <div class="col-md-6 mb-3">
                    <h6>Tenure:</h6>
                    <p class="fw-semibold">@Model.TenureMonths / 12 years</p>
                </div>
            </div>

            <hr class="my-4" />

            <!-- Progress Status -->
            <h5 class="text-primary mb-3">Application Progress</h5>
            <div class="progress" style="height: 25px;">
                @{
                    var status = Model.Status?.ToLower() ?? "";
                    int progress = status switch
                    {
                        var s when s.Contains("sent") => 25,
                        var s when s.Contains("under verification") => 50,
                        var s when s.Contains("approved") => 75,
                        var s when s.Contains("disbursed") => 100,
                        _ => 15
                    };
                }
                <div class="progress-bar progress-bar-striped progress-bar-animated"
                     role="progressbar"
                     style="width:@progress%; background-color:#004aad;">
                    @Model.Status
                </div>
            </div>

            <!-- Timeline Display -->
            <div class="timeline mt-4">
                <div class="timeline-step @(progress >= 25 ? "active" : "")">
                    <div class="circle">1</div>
                    <p>Application Sent</p>
                </div>
                <div class="timeline-step @(progress >= 50 ? "active" : "")">
                    <div class="circle">2</div>
                    <p>Under Verification</p>
                </div>
                <div class="timeline-step @(progress >= 75 ? "active" : "")">
                    <div class="circle">3</div>
                    <p>Approved</p>
                </div>
                <div class="timeline-step @(progress == 100 ? "active" : "")">
                    <div class="circle">4</div>
                    <p>Disbursed</p>
                </div>
            </div>

            <div class="text-center mt-5">
                <a href="/LoanTracker" class="btn btn-outline-primary">🔁 Track Another Application</a>
                <a href="/Home/Index" class="btn btn-primary ms-2">🏠 Back to Home</a>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border-radius: 12px;
    }

    .card-header {
        border-top-left-radius: 12px;
        border-top-right-radius: 12px;
    }

    .timeline {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        margin-top: 2rem;
    }

        .timeline::before {
            content: "";
            position: absolute;
            top: 18px;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: #d3d3d3;
            z-index: 0;
        }

    .timeline-step {
        text-align: center;
        position: relative;
        z-index: 1;
        width: 25%;
    }

        .timeline-step .circle {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: #ccc;
            color: #fff;
            font-weight: 600;
            margin: 0 auto 10px auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timeline-step.active .circle {
            background-color: #004aad;
        }

        .timeline-step p {
            font-size: 14px;
            margin-bottom: 0;
        }

    .progress {
        border-radius: 8px;
    }
</style>

